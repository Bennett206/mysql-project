show databases;

-- CREATE DATABASE mariners_2022;

USE mariners_2022;

DROP TABLE IF EXISTS pitching_log;

CREATE TABLE pitching_log(
	gameID INT(5) AUTO_INCREMENT,
	gameDate DATE not null,
	location varchar(5) not null,
	opponent varchar(5),
	inningsPitched int,
	hits int,
	battersFacedPitcher int,
	homeruns int,
	runs int,
	earnedRuns int,
	walks int,
	intentionalWalks int,
	strikeouts int,
	sacrificeHits int,
    sacrificeFlies int,
	wildPitches int,
	hitByPitches int,
	balks int,
	doubles int,
	triples int,
	PRIMARY KEY(`gameID`)
);

-- create VIEW to check daily OBP
CREATE VIEW daily_OBP_2022_04_10 AS
SELECT
-- show game date
p.gameDate AS 'Date',
-- show the opponent
p.opponent,
-- show how many batters were faced
p.battersFacedPitcher AS 'Batters Faced',
-- calculate how many batters reached a base
hits + homeruns + walks + hitByPitches AS 'Batters Reached Base',
-- calculate the On Base Percentage
(hits + homeruns + walks + hitByPitches) / p.battersFacedPitcher AS 'On Base Percentage',
-- show the outcome
outcome
-- join the pitching and game log 
FROM pitching_log p JOIN game_log g
-- join using the game date
ON p.gameDate = g.gameDate
-- only check stats for this date
WHERE g.gameDate = '2022-04-08';

SELECT * FROM daily_OBP_2022_04_10;

INSERT INTO pitching_log VALUES
(NULL,"2022-04-08","MIN","MIN",9,4,34,1,1,1,4,0,6,0,0,0,1,0,0,0),
(NULL,"2022-04-09","MIN","MIN",9,4,34,2,3,3,2,0,14,0,0,0,1,0,0,0),
(NULL,"2022-04-10","MIN","MIN",8,10,38,6,10,6,3,0,9,0,0,1,0,0,1,0),
(NULL,"2022-04-11","MIN","MIN",8,10,36,0,4,4,3,0,8,0,0,0,0,0,3,0),
(NULL,"2022-04-12","CHIW","CHIW",8,6,33,1,3,3,3,0,9,0,0,1,0,0,0,0),
(NULL,"2022-04-13","CHIW","CHIW",8,10,36,3,6,6,4,0,6,0,0,1,0,0,1,0),
(NULL,"2022-04-14","CHIW","CHIW",9,4,33,0,1,0,1,0,9,0,0,0,0,0,0,0),
(NULL,"2022-04-15","SEA","HOU",9,5,32,0,1,1,0,0,8,0,0,0,1,0,1,0),
(NULL,"2022-04-16","SEA","HOU",9,8,38,1,4,4,3,0,7,0,1,0,0,0,2,1),
(NULL,"2022-04-17","SEA","HOU",9,4,35,1,2,2,7,0,10,0,0,1,1,0,1,0),
(NULL,"2022-04-19","SEA","TEX",9,6,34,0,2,2,1,0,5,0,1,0,0,0,2,0),
(NULL,"2022-04-20","SEA","TEX",9,8,34,0,2,1,0,0,6,0,1,0,0,0,1,0),
(NULL,"2022-04-21","SEA","TEX",9,10,43,1,8,4,3,0,11,0,1,0,0,0,5,0),
(NULL,"2022-04-22","SEA","KC",9,8,33,1,1,1,1,0,6,0,0,0,0,0,1,0),
(NULL,"2022-04-23","SEA","KC",9,10,43,1,7,6,5,0,9,0,0,0,1,0,3,0),
(NULL,"2022-04-24","SEA","KC",12,9,47,1,4,3,4,0,13,0,0,0,0,0,3,0),
(NULL,"2022-04-26","TB","TB",9,9,40,2,4,4,5,0,12,0,0,1,0,0,0,0),
(NULL,"2022-04-27","TB","TB",8,7,34,1,3,3,3,0,7,0,0,0,1,0,0,0),
(NULL,"2022-04-28","TB","TB",8,7,33,0,2,2,5,0,5,1,0,0,0,0,0,0),
(NULL,"2022-04-29","MIA","MIA",8,10,37,2,8,8,3,0,9,0,0,0,2,0,1,1),
(NULL,"2022-04-30","MIA","MIA",8,6,34,0,3,3,5,0,12,0,0,0,0,0,1,0),
(NULL,"2022-05-01","MIA","MIA",9,10,42,2,3,3,4,0,8,0,0,0,0,0,1,0),
(NULL,"2022-05-02","HOU","HOU",8,8,34,2,3,3,2,0,4,0,0,0,0,0,3,0),
(NULL,"2022-05-03","HOU","HOU",8,5,34,2,4,4,6,0,4,0,0,0,0,0,0,0),
(NULL,"2022-05-04","HOU","HOU",8,10,37,0,7,7,5,0,9,0,1,0,0,0,3,0),
(NULL,"2022-05-05","SEA","TB",9,7,35,1,4,4,1,0,8,0,0,0,0,0,0,0),
(NULL,"2022-05-06","SEA","TB",9,13,43,1,8,7,4,0,10,0,0,0,1,0,2,0),
(NULL,"2022-05-07","SEA","TB",9,10,41,3,8,7,6,0,5,0,0,1,0,0,1,0),
(NULL,"2022-05-08","SEA","TB",10,5,35,1,1,1,2,1,14,0,0,0,0,0,0,0),
(NULL,"2022-05-09","SEA","PHI",9,17,46,2,9,9,2,0,10,0,0,0,0,0,3,0),
(NULL,"2022-05-10","SEA","PHI",9,5,35,3,4,4,3,0,13,0,0,2,0,0,2,0),
(NULL,"2022-05-11","SEA","PHI",9,7,35,1,4,4,3,0,13,0,0,0,0,0,0,0),
(NULL,"2022-05-13","NYM","NYM",9,5,35,0,1,1,3,0,7,1,1,0,0,0,2,0),
(NULL,"2022-05-14","NYM","NYM",8,7,34,1,5,3,1,0,5,0,2,1,0,0,2,1),
(NULL,"2022-05-15","NYM","NYM",9,9,40,1,7,7,4,1,12,0,0,0,1,0,2,3),
(NULL,"2022-05-16","TOR","TOR",8,10,39,2,6,6,5,0,10,0,0,1,1,0,0,0),
(NULL,"2022-05-17","TOR","TOR",8,6,34,0,3,3,4,0,10,0,0,0,1,0,1,1),
(NULL,"2022-05-18","TOR","TOR",9,7,35,0,1,1,4,0,2,0,0,0,0,0,1,0),
(NULL,"2022-05-19","BOS","BOS",8,16,44,3,12,12,4,0,7,0,0,1,1,0,4,0),
(NULL,"2022-05-20","BOS","BOS",8,8,34,2,7,7,2,0,9,0,0,0,0,0,1,0),
(NULL,"2022-05-21","BOS","BOS",8,11,37,2,6,6,3,0,5,0,1,0,0,0,2,1),
(NULL,"2022-05-22","BOS","BOS",9.2,10,41,3,8,7,3,2,7,0,1,0,0,0,3,0),
(NULL,"2022-05-23","SEA","OAK",9,12,40,1,6,6,2,0,7,0,1,1,0,0,2,0),
(NULL,"2022-05-24","SEA","OAK",9,13,41,2,7,7,2,0,11,0,0,0,0,0,4,0),
(NULL,"2022-05-25","SEA","OAK",9,9,37,2,4,4,2,0,12,0,0,1,0,0,3,0),
(NULL,"2022-05-27","SEA","HOU",9,9,37,0,1,1,2,0,8,0,0,0,0,0,1,0),
(NULL,"2022-05-28","SEA","HOU",9,5,34,0,0,0,1,0,6,0,0,0,1,0,1,0),
(NULL,"2022-05-29","SEA","HOU",9,6,35,1,2,2,3,1,3,0,0,0,0,0,1,0),
(NULL,"2022-05-31","BAL","BAL",9,5,33,0,0,0,1,0,12,0,0,0,1,0,1,0),
(NULL,"2022-06-01","BAL","BAL",8,10,37,4,9,9,6,0,7,0,0,0,0,0,3,0),
(NULL,"2022-06-02","BAL","BAL",10,8,42,0,6,6,2,0,8,0,0,1,2,0,5,0),
(NULL,"2022-06-03","TEX","TEX",9,7,37,1,3,2,2,0,12,0,0,0,0,0,3,0),
(NULL,"2022-06-04","TEX","TEX",8,5,30,1,3,3,1,0,5,0,0,0,0,0,0,0),
(NULL,"2022-06-05","TEX","TEX",10,9,40,4,5,5,1,1,8,0,0,0,0,0,0,0),
(NULL,"2022-06-06","HOU","HOU",9,10,40,3,4,3,5,0,7,0,0,0,0,0,1,0),
(NULL,"2022-06-07","HOU","HOU",8,7,35,1,4,4,5,0,3,0,0,1,0,0,0,0),
(NULL,"2022-06-08","HOU","HOU",9,8,36,0,3,3,3,0,7,0,0,1,0,0,3,0),
(NULL,"2022-06-10","SEA","BOS",9,6,39,2,4,4,6,0,9,0,0,0,1,0,1,0),
(NULL,"2022-06-11","SEA","BOS",9,8,36,3,6,4,1,0,9,0,0,0,0,0,0,0),
(NULL,"2022-06-12","SEA","BOS",9,4,34,1,2,2,1,0,6,0,0,0,3,0,2,0),
(NULL,"2022-06-13","SEA","MIN",9,9,40,1,3,3,4,0,11,0,0,1,0,0,1,0),
(NULL,"2022-06-14","SEA","MIN",9,4,32,0,0,0,2,0,9,0,0,0,0,0,0,0),
(NULL,"2022-06-15","SEA","MIN",9,8,38,0,5,5,4,0,4,0,0,2,0,0,3,0),
(NULL,"2022-06-16","SEA","ANA",9,10,38,2,4,4,1,0,9,0,0,0,0,0,0,0),
(NULL,"2022-06-17","SEA","ANA",9,4,33,0,1,1,1,0,11,0,0,1,1,0,1,1),
(NULL,"2022-06-18","SEA","ANA",10,7,39,1,4,3,2,0,12,0,0,1,0,0,3,0),
(NULL,"2022-06-18","SEA","ANA",9,7,35,2,3,3,1,0,6,0,0,1,0,0,2,0),
(NULL,"2022-06-19","SEA","ANA",9,9,35,1,4,3,0,0,11,0,0,0,0,0,1,0),
(NULL,"2022-06-21","OAK","OAK",9,7,34,1,2,2,1,0,4,0,0,0,0,0,1,0),
(NULL,"2022-06-22","OAK","OAK",9,7,34,0,0,0,1,0,7,0,0,0,0,0,0,0),
(NULL,"2022-06-23","OAK","OAK",9,5,34,0,1,1,2,0,12,0,0,0,1,0,1,0),
(NULL,"2022-06-24","ANA","ANA",9,7,34,1,3,3,3,1,10,0,0,0,0,0,0,1),
(NULL,"2022-06-25","ANA","ANA",9,10,39,2,3,3,4,2,8,0,0,2,0,0,1,0),
(NULL,"2022-06-26","ANA","ANA",8,6,36,1,2,2,7,2,8,0,0,1,0,0,1,0),
(NULL,"2022-06-27","SEA","BAL",9,12,41,5,9,9,1,0,6,0,1,0,1,0,3,0),
(NULL,"2022-06-28","SEA","BAL",9,1,32,0,0,0,3,0,11,0,0,0,1,0,0,0),
(NULL,"2022-06-29","SEA","BAL",9,8,39,0,3,3,4,0,8,0,0,1,0,0,3,0),
(NULL,"2022-06-30","SEA","OAK",9,11,40,3,6,6,2,0,7,1,0,0,0,0,0,0),
(NULL,"2022-07-01","SEA","OAK",9,12,41,1,3,3,1,0,6,0,0,0,1,0,3,0),
(NULL,"2022-07-02","SEA","OAK",9,4,31,0,1,1,2,0,12,0,1,0,0,0,0,0),
(NULL,"2022-07-03","SEA","OAK",9,4,32,1,1,1,2,0,16,0,0,0,0,0,0,0),
(NULL,"2022-07-04","SD","SD",9,7,38,1,2,2,5,0,9,0,0,1,0,0,0,0),
(NULL,"2022-07-05","SD","SD",9,8,40,0,2,1,4,0,8,0,1,0,0,0,2,0),
(NULL,"2022-07-07","SEA","TOR",9,10,37,0,3,2,0,0,1,0,0,0,2,0,1,0),
(NULL,"2022-07-08","SEA","TOR",11,12,46,0,2,2,3,0,12,0,0,0,0,0,2,0),
(NULL,"2022-07-09","SEA","TOR",9,5,34,1,1,1,3,1,10,0,0,0,0,0,0,0),
(NULL,"2022-07-10","SEA","TOR",9,10,37,3,5,5,0,0,10,0,0,0,0,0,2,0),
(NULL,"2022-07-13","WAS","WAS",9,10,40,1,4,4,3,1,3,0,1,0,1,0,2,0),
(NULL,"2022-07-13","WAS","WAS",9,6,34,1,1,1,5,0,6,0,0,0,0,0,1,0),
(NULL,"2022-07-14","TEX","TEX",9,12,39,0,5,5,3,1,8,0,1,0,0,0,4,0),
(NULL,"2022-07-15","TEX","TEX",9,6,33,2,3,3,0,0,17,0,0,0,0,0,1,0),
(NULL,"2022-07-16","TEX","TEX",10,7,36,0,2,2,1,0,12,0,0,0,0,0,2,1),
(NULL,"2022-07-17","TEX","TEX",9,7,39,1,2,2,5,0,10,0,0,0,0,0,1,0),
(NULL,"2022-07-22","SEA","HOU",9,10,37,3,5,5,1,0,4,0,1,0,0,0,2,0),
(NULL,"2022-07-23","SEA","HOU",9,7,36,0,3,3,2,0,10,1,0,1,1,0,3,0),
(NULL,"2022-07-24","SEA","HOU",9,12,40,2,8,8,3,0,7,0,0,0,0,0,3,0),
(NULL,"2022-07-25","SEA","TEX",9,6,37,2,3,3,4,0,7,0,0,1,0,0,1,0),
(NULL,"2022-07-26","SEA","TEX",9,7,36,0,4,4,4,0,7,1,0,0,0,0,2,0),
(NULL,"2022-07-27","SEA","TEX",9,6,35,0,2,2,2,0,6,0,0,0,0,0,4,0),
(NULL,"2022-07-28","HOU","HOU",8,6,33,1,4,4,2,0,8,0,0,1,1,0,3,0),
(NULL,"2022-07-29","HOU","HOU",8,15,47,4,11,11,7,0,5,0,1,3,1,0,2,0),
(NULL,"2022-07-30","HOU","HOU",9,9,39,1,4,4,4,0,3,0,0,2,0,0,3,0),
(NULL,"2022-07-31","HOU","HOU",9.1,7,39,0,3,2,3,1,11,0,0,0,1,0,1,0),
(NULL,"2022-08-01","NYY","NYY",8,10,37,4,7,7,3,0,8,0,0,0,0,0,1,0),
(NULL,"2022-08-02","NYY","NYY",9,10,40,3,6,6,7,0,9,0,0,2,0,0,3,0),
(NULL,"2022-08-03","NYY","NYY",9,5,34,1,3,3,3,0,8,0,0,0,0,0,2,0),
(NULL,"2022-08-05","SEA","ANA",10,8,38,1,4,3,2,0,13,1,1,0,1,0,1,1),
(NULL,"2022-08-06","SEA","ANA",9,7,35,0,1,1,0,0,13,0,0,1,1,0,2,0),
(NULL,"2022-08-06","SEA","ANA",9,8,39,2,7,6,3,0,6,0,1,0,0,0,1,0),
(NULL,"2022-08-07","SEA","ANA",9,8,35,0,3,3,1,0,11,1,0,0,0,0,2,0),
(NULL,"2022-08-08","SEA","NYY",9,13,44,2,9,9,3,0,7,0,1,0,1,0,6,0),
(NULL,"2022-08-09","SEA","NYY",13,3,42,0,0,0,4,1,14,0,0,0,1,0,0,0),
(NULL,"2022-08-10","SEA","NYY",9,4,36,2,3,3,5,0,9,0,0,1,0,0,0,0),
(NULL,"2022-08-12","TEX","TEX",9,9,36,0,2,2,2,0,12,0,0,0,0,0,0,0),
(NULL,"2022-08-13","TEX","TEX",8,12,40,1,7,6,5,1,5,1,0,0,0,0,4,0),
(NULL,"2022-08-14","TEX","TEX",8,8,35,0,5,5,4,0,8,0,0,2,0,0,4,0),
(NULL,"2022-08-15","ANA","ANA",9,8,36,1,2,2,1,0,13,0,0,0,1,0,1,0),
(NULL,"2022-08-16","ANA","ANA",9,7,36,1,2,2,3,0,13,0,0,0,0,0,0,1),
(NULL,"2022-08-17","ANA","ANA",9,10,40,1,7,7,2,0,11,0,1,0,1,0,1,1),
(NULL,"2022-08-19","OAK","OAK",9,6,35,0,2,1,2,0,5,0,1,0,1,0,2,0),
(NULL,"2022-08-20","OAK","OAK",9,8,40,0,4,2,4,1,10,2,0,0,0,0,1,0),
(NULL,"2022-08-21","OAK","OAK",8,12,36,0,5,5,1,0,9,1,1,0,2,0,4,1),
(NULL,"2022-08-23","SEA","WAS",9,5,33,1,2,2,2,0,10,0,0,0,0,0,1,0),
(NULL,"2022-08-24","SEA","WAS",9,10,36,1,3,3,1,0,11,1,0,0,0,0,1,0),
(NULL,"2022-08-25","SEA","CLE",9,6,33,0,1,1,1,0,7,0,0,0,0,0,1,0),
(NULL,"2022-08-26","SEA","CLE",11,9,43,0,2,2,3,1,5,0,2,0,0,0,4,0),
(NULL,"2022-08-27","SEA","CLE",9,6,36,1,4,4,2,0,12,0,1,0,0,0,1,0),
(NULL,"2022-08-28","SEA","CLE",9,5,31,0,0,0,0,0,9,0,0,0,0,0,1,0),
(NULL,"2022-08-30","DET","DET",9,7,36,0,3,3,1,0,8,0,1,0,0,0,1,2),
(NULL,"2022-08-31","DET","DET",9,8,39,0,3,3,3,0,7,0,0,1,2,0,0,0),
(NULL,"2022-09-01","DET","DET",9,4,32,0,0,0,1,0,11,0,0,0,0,0,0,0),
(NULL,"2022-09-02","CLE","CLE",9,9,36,0,1,1,1,0,5,0,0,0,1,0,1,0),
(NULL,"2022-09-03","CLE","CLE",9,9,36,0,0,0,1,0,4,0,0,0,1,0,0,0),
(NULL,"2022-09-04","CLE","CLE",11,9,46,0,3,3,5,2,8,0,0,0,2,0,1,0),
(NULL,"2022-09-05","SEA","CHIW",9,5,35,2,3,3,2,0,5,0,0,0,0,0,1,0),
(NULL,"2022-09-06","SEA","CHIW",9,7,36,0,0,0,2,0,14,0,0,0,1,0,1,0),
(NULL,"2022-09-07","SEA","CHIW",9,8,40,1,9,3,3,1,12,1,2,0,0,0,2,0),
(NULL,"2022-09-09","SEA","ATL",9,10,40,4,6,6,2,0,10,0,0,0,1,0,1,0),
(NULL,"2022-09-10","SEA","ATL",9,3,30,0,1,0,0,0,9,0,0,0,0,0,0,0),
(NULL,"2022-09-11","SEA","ATL",9,6,38,4,7,7,4,0,9,0,0,0,1,0,1,0),
(NULL,"2022-09-13","SEA","SD",9,8,40,0,2,1,4,1,11,2,0,0,0,0,2,0),
(NULL,"2022-09-14","SEA","SD",9,7,37,0,1,1,2,0,14,0,0,0,1,0,2,0),
(NULL,"2022-09-16","ANA","ANA",8,11,38,3,8,8,3,0,11,0,0,0,0,0,2,0),
(NULL,"2022-09-17","ANA","ANA",8,4,29,0,2,2,1,0,12,0,0,1,1,0,1,0),
(NULL,"2022-09-18","ANA","ANA",8,8,34,3,5,5,3,0,5,0,0,0,0,0,0,0),
(NULL,"2022-09-19","ANA","ANA",9,8,37,0,1,1,2,0,15,0,1,0,0,0,2,0),
(NULL,"2022-09-20","OAK","OAK",8,7,34,1,4,4,4,0,8,0,0,0,0,0,2,0),
(NULL,"2022-09-21","OAK","OAK",8,6,33,0,2,2,4,0,8,0,0,0,0,0,1,0),
(NULL,"2022-09-22","OAK","OAK",9,9,40,0,5,5,4,0,5,1,0,0,0,0,3,1),
(NULL,"2022-09-23","KC","KC",8,10,35,0,5,4,1,0,5,0,0,0,0,0,3,0),
(NULL,"2022-09-24","KC","KC",9,9,37,1,5,5,1,0,4,1,1,1,1,0,2,1),
(NULL,"2022-09-25","KC","KC",8,14,42,1,13,13,7,0,6,0,0,0,0,0,4,0),
(NULL,"2022-09-27","SEA","TEX",9,7,37,2,5,5,3,1,12,0,0,0,1,0,0,0),
(NULL,"2022-09-28","SEA","TEX",9,5,31,0,1,1,1,0,7,0,0,0,0,0,1,0),
(NULL,"2022-09-29","SEA","TEX",11,12,47,5,9,7,4,0,12,1,1,0,0,0,0,0),
(NULL,"2022-09-30","SEA","OAK",9,3,30,1,1,1,2,0,6,0,0,0,0,0,0,0),
(NULL,"2022-10-01","SEA","OAK",9,2,31,0,1,1,2,0,11,0,0,0,0,0,0,0),
(NULL,"2022-10-02","SEA","OAK",9,12,43,4,10,9,4,0,5,0,0,0,0,0,1,0),
(NULL,"2022-10-03","SEA","DET",9,8,39,1,4,4,5,0,11,0,0,0,0,0,1,0),
(NULL,"2022-10-04","SEA","DET",10,10,41,2,6,5,1,0,9,0,1,1,0,0,3,0),
(NULL,"2022-10-04","SEA","DET",9,8,41,2,6,6,4,0,9,0,1,0,1,0,0,0),
(NULL,"2022-10-05","SEA","DET",9,8,37,0,4,3,2,0,10,0,0,0,0,0,1,0);

SELECT * FROM pitching_log;

